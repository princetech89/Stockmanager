{% extends "base.html" %}

{% block title %}Billing - Stock Inventory Management{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">Billing & Invoices</h1>
    <div class="page-actions">
        <button class="btn btn-primary" onclick="openCreateInvoiceModal()">
            <i class="fas fa-plus"></i>
            Create Invoice
        </button>
    </div>
</div>

<!-- Invoice Creation Form -->
<div class="billing-container">
    <div class="invoice-form-card">
        <div class="card-header">
            <h3>Create New Invoice</h3>
        </div>
        <div class="card-body">
            <form id="invoiceForm">
                <!-- Customer Details -->
                <div class="form-section">
                    <h4>Customer Details</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="customerName">Customer Name *</label>
                            <input type="text" class="form-control" id="customerName" required>
                        </div>
                        <div class="form-group">
                            <label for="customerMobile">Mobile Number</label>
                            <input type="tel" class="form-control" id="customerMobile">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="customerGST">GST Number</label>
                            <input type="text" class="form-control" id="customerGST" placeholder="22AAAAA0000A1Z5">
                        </div>
                        <div class="form-group">
                            <label for="customerAddress">Address</label>
                            <textarea class="form-control" id="customerAddress" rows="2"></textarea>
                        </div>
                    </div>
                </div>

                <!-- Invoice Items -->
                <div class="form-section">
                    <div class="section-header">
                        <h4>Invoice Items</h4>
                        <button type="button" class="btn btn-sm btn-primary" onclick="addInvoiceItem()">
                            <i class="fas fa-plus"></i> Add Item
                        </button>
                    </div>
                    
                    <div class="invoice-items-table">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Product</th>
                                    <th>HSN Code</th>
                                    <th>Qty</th>
                                    <th>Rate (₹)</th>
                                    <th>GST (%)</th>
                                    <th>Amount (₹)</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody id="invoiceItemsBody">
                                <!-- Invoice items will be added here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Invoice Summary -->
                <div class="form-section">
                    <h4>Invoice Summary</h4>
                    <div class="invoice-summary">
                        <div class="summary-row">
                            <span>Subtotal:</span>
                            <span id="subtotal">₹0.00</span>
                        </div>
                        <div class="summary-row">
                            <span>CGST:</span>
                            <span id="cgstAmount">₹0.00</span>
                        </div>
                        <div class="summary-row">
                            <span>SGST:</span>
                            <span id="sgstAmount">₹0.00</span>
                        </div>
                        <div class="summary-row">
                            <span>IGST:</span>
                            <span id="igstAmount">₹0.00</span>
                        </div>
                        <div class="summary-row total">
                            <span><strong>Total Amount:</strong></span>
                            <span id="totalAmount"><strong>₹0.00</strong></span>
                        </div>
                    </div>
                </div>

                <!-- Form Actions -->
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="clearInvoiceForm()">
                        <i class="fas fa-times"></i>
                        Clear
                    </button>
                    <button type="button" class="btn btn-outline" onclick="previewInvoice()">
                        <i class="fas fa-eye"></i>
                        Preview
                    </button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i>
                        Generate Invoice
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Recent Invoices -->
<div class="dashboard-section">
    <div class="section-header">
        <h3>Recent Invoices</h3>
        <div class="section-actions">
            <input type="text" placeholder="Search invoices..." id="invoiceSearch" class="form-control">
        </div>
    </div>
    
    <div class="table-container">
        <table class="data-table" id="invoicesTable">
            <thead>
                <tr>
                    <th>Invoice No.</th>
                    <th>Customer</th>
                    <th>Date</th>
                    <th>Amount (₹)</th>
                    <th>GST (₹)</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="invoicesTableBody">
                <!-- Invoice rows will be loaded here -->
            </tbody>
        </table>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/billing.js') }}"></script>
{% endblock %}
